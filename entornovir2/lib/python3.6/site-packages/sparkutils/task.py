from collections import namedtuple
from pyspark.sql import SparkSession

# ==============================================================================

# FUTURE: Replace this implementation with a typing.NamedTuple whenever Python 3.6 becomes available
BusinessInformation = namedtuple("BusinessInformation", "exitCode entity path mode schema schemaVersion reprocessing")

# ===============================================================================


class PySparkTask(object):
    """
    PySparkTask implements com.datio.spark.IInitSparkDelegate
    for executing Python logic from spark-utils package
    """

    def runProcess(self, spark: SparkSession, config) -> int:
        """
        Execute the task
        :param spark: the applicable Spark session
        :param config: the process configuration
        :return: an exit code that describes the process results
        """
        raise NotImplementedError

    def defineBusinessInfo(self, config) -> BusinessInformation:
        """
        Define the BusinessInformation for the implemented process
        :param config: the process configuration
        :return: the BusinessInformation object for this process
        """
        raise NotImplementedError
